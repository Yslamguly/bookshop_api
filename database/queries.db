--A query to display the books of the user`s shopping cart
select  b.id,isbn,title, publication_year, selling_price, image,a.first_name ,a.last_name, sci2.quantity, sci2.price,sci2.total_price
from books b join authors a on b.author_id = a.id join shopping_cart_item sci2  on sci2.book_id = b.id
where b.id in (select book_id from shopping_cart_item sci left join shopping_cart sc on sci.cart_id  = sc.id where sc.customer_id = 58) and sci2.cart_id = 9


--A query to add books to users' shopping cart
insert into shopping_cart_item (cart_id, book_id )
VALUES
((SELECT id
        FROM   shopping_cart
        WHERE  customer_id = 58),
        14)

--A query to delete books from users' shopping cart
delete from shopping_cart_item where cart_id = (SELECT id
        FROM   shopping_cart
        WHERE  customer_id = 58) and
        book_id = 1

--A query to display books with filters
select b.id,isbn,title,publication_year,selling_price,image from books b join book_category bc on bc.book_id = b.id where bc.category_id = 3
and (selling_price between 0 and 500)
and (publication_year between 0 and 2022) order by b.id

--A query to get book information by book_id
select b.id,b.isbn ,b.title,b.publication_year,b.selling_price,b.image, a.first_name,a.last_name
from books b  join authors a on b.author_id =  a.id
where b.id = 15;

-- A query to get user addresses
select a.address_line ,a.city,a.region,a.postal_code,c2.country_name
from addresses a join countries c2 on a.country_id  = c2.id
where a.id in (select address_id from customer_addresses ca2 left join customers c on ca2.customer_id = c.id where c.id = {customer_id})


